
<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Lane Division Demo ‚Äî Two-wheeler / Emergency / Four-wheeler</title>
<style>
  :root{
    --bg:#f4f7fb;
    --card:#ffffff;
    --muted:#6b7280;
    --accent:#0b74de;
    --danger:#ef4444;
    --ok:#10b981;
    --lane1:#fff9f1;
    --lane2:#f1fcff;
    --lane3:#f6fff5;
    --shadow: 0 6px 18px rgba(17,24,39,0.06);
    font-family: Inter, system-ui, "Segoe UI", Roboto, "Helvetica Neue", Arial;
  }
  body{
    margin:0;
    background:linear-gradient(180deg,var(--bg),#eef4ff);
    min-height:100vh;
    color:#111827;
    padding:20px;
    box-sizing:border-box;
  }

  header{
    display:flex;
    align-items:center;
    justify-content:space-between;
    gap:12px;
    margin-bottom:16px;
  }
  header h1{font-size:1.15rem;margin:0;}
  header p{margin:0;color:var(--muted);font-size:0.95rem;}

  .container{
    display:grid;
    grid-template-columns:320px 1fr;
    gap:20px;
    align-items:start;
  }

  /* Palette */
  .palette{
    background:var(--card);
    border-radius:12px;
    padding:14px;
    box-shadow:var(--shadow);
  }
  .palette h2{margin:0 0 10px 0;font-size:1rem}
  .vehicles{
    display:flex;
    flex-direction:column;
    gap:10px;
  }
  .vehicle{
    display:flex;
    gap:10px;
    align-items:center;
    padding:10px;
    border-radius:8px;
    cursor:grab;
    user-select:none;
    border:1px dashed rgba(15,23,42,0.06);
    background:linear-gradient(180deg, #fff, #fbfdff);
  }
  .vehicle .icon{
    width:42px;height:42px;border-radius:8px;
    display:grid;place-items:center;font-weight:700;
    font-size:1.1rem;
  }
  .vehicle.two .icon{background:linear-gradient(180deg,#fff7ed,#fff2e6);color:#b45309}
  .vehicle.emg .icon{background:linear-gradient(180deg,#f0f9ff,#e6f7ff);color:#0369a1}
  .vehicle.four .icon{background:linear-gradient(180deg,#f0fff4,#e6ffee);color:#065f46}

  .vehicle .meta{display:flex;flex-direction:column}
  .vehicle .meta .t{font-weight:600}
  .vehicle .meta .s{font-size:0.85rem;color:var(--muted)}

  /* Road area */
  .road{
    background:transparent;
    display:flex;
    flex-direction:column;
    gap:12px;
  }
  .lane{
    display:flex;
    flex-direction:column;
    gap:8px;
    padding:12px;
    border-radius:10px;
    min-height:110px;
    border:1px solid rgba(2,6,23,0.06);
    box-shadow:var(--shadow);
  }
  .lane-label{
    display:flex;align-items:center;justify-content:space-between;
    gap:12px;
  }
  .lane .dropzone{
    border-radius:8px;
    min-height:56px;
    display:flex;
    gap:8px;
    align-items:center;
    padding:8px;
    flex-wrap:wrap;
    outline:2px dashed transparent;
  }
  .lane1{background:var(--lane1)}
  .lane2{background:var(--lane2)}
  .lane3{background:var(--lane3)}

  .dropzone.dragover{outline-color:rgba(11,116,222,0.35);background:linear-gradient(90deg, rgba(11,116,222,0.03), transparent)}

  .dropped{
    display:inline-flex;
    align-items:center;
    gap:8px;
    padding:6px 8px;
    border-radius:8px;
    border:1px solid rgba(15,23,42,0.06);
    background:white;
    font-weight:600;
    font-size:0.9rem;
  }

  footer{
    margin-top:18px;color:var(--muted);
    font-size:0.9rem;
  }

  /* message */
  .msg{
    position:fixed;
    right:20px;
    bottom:20px;
    padding:12px 14px;
    border-radius:10px;
    box-shadow:var(--shadow);
    background:var(--card);
    display:flex;
    gap:10px;
    align-items:center;
    min-width:240px;
  }
  .msg.ok{border-left:6px solid var(--ok)}
  .msg.err{border-left:6px solid var(--danger)}

  /* Responsive */
  @media (max-width:920px){
    .container{grid-template-columns:1fr; padding-bottom:40px}
  }
</style>
</head>
<body>
<header>
  <div>
    <h1>Lane Division ‚Äî Demo (India rules style)</h1>
    <p>Lane 1: Two-wheelers ‚Ä¢ Lane 2: Emergency vehicles ‚Ä¢ Lane 3: Four-wheelers</p>
  </div>
  <div style="text-align:right">
    <small style="color:var(--muted)">Drag vehicles into lanes. Wrong placements are blocked.</small>
  </div>
</header>

<div class="container">
  <!-- Left: Palette -->
  <aside class="palette" aria-label="Vehicle palette">
    <h2>Vehicle palette</h2>
    <div class="vehicles" id="palette">
      <div class="vehicle two" draggable="true" data-type="two" id="v-bike">
        <div class="icon">üèçÔ∏è</div>
        <div class="meta"><div class="t">Two-wheeler</div><div class="s">Motorbike / Scooter</div></div>
      </div>
      <div class="vehicle emg" draggable="true" data-type="emg" id="v-ambulance">
        <div class="icon">üöë</div>
        <div class="meta"><div class="t">Emergency</div><div class="s">Ambulance / Fire</div></div>
      </div>
      <div class="vehicle four" draggable="true" data-type="four" id="v-car">
        <div class="icon">üöó</div>
        <div class="meta"><div class="t">Four-wheeler</div><div class="s">Car / SUV</div></div>
      </div>
      <div style="margin-top:10px;color:var(--muted);font-size:0.9rem">
        Tip: drag an icon and drop onto a lane below.
      </div>
    </div>
  </aside>

  <!-- Right: Road and lanes -->
  <main class="road" role="main">
    <section class="lane lane1" aria-label="Lane 1 (Two-wheeler)">
      <div class="lane-label">
        <strong>Lane 1 ‚Äî Two-wheelers</strong>
        <small style="color:var(--muted)">Allowed: Two-wheeler</small>
      </div>
      <div class="dropzone" data-allowed='["two"]' id="lane-1"></div>
    </section>

    <section class="lane lane2" aria-label="Lane 2 (Emergency)">
      <div class="lane-label">
        <strong>Lane 2 ‚Äî Emergency Vehicles</strong>
        <small style="color:var(--muted)">Allowed: Emergency vehicles only</small>
      </div>
      <div class="dropzone" data-allowed='["emg"]' id="lane-2"></div>
    </section>

    <section class="lane lane3" aria-label="Lane 3 (Four-wheeler)">
      <div class="lane-label">
        <strong>Lane 3 ‚Äî Four-wheelers</strong>
        <small style="color:var(--muted)">Allowed: Cars / Four-wheelers</small>
      </div>
      <div class="dropzone" data-allowed='["four"]' id="lane-3"></div>
    </section>

    <footer>
      This demo enforces the lane rules you provided. It is a UI simulation only and not an official legal source.
    </footer>
  </main>
</div>

<!-- Message container -->
<div id="message-area" aria-live="polite" style="display:none"></div>

<script>
  // Allowed mapping described in the UI; we use data attributes on each dropzone.
  // Drag & drop handling
  const vehicles = document.querySelectorAll('.vehicle[draggable="true"]');
  vehicles.forEach(v => {
    v.addEventListener('dragstart', ev => {
      ev.dataTransfer.setData('text/plain', v.id); // transfer id
      // small visual hint
      v.style.opacity = '0.6';
    });
    v.addEventListener('dragend', ev => { v.style.opacity = ''; });
  });

  const dropzones = document.querySelectorAll('.dropzone');
  dropzones.forEach(dz => {
    dz.addEventListener('dragover', ev => {
      ev.preventDefault();
      dz.classList.add('dragover');
    });
    dz.addEventListener('dragleave', ev => {
      dz.classList.remove('dragover');
    });
    dz.addEventListener('drop', ev => {
      ev.preventDefault();
      dz.classList.remove('dragover');
      const vid = ev.dataTransfer.getData('text/plain');
      const vehicle = document.getElementById(vid);
      if(!vehicle){
        showMessage('Unknown vehicle.', 'err');
        return;
      }
      const vtype = vehicle.dataset.type; // 'two', 'emg', 'four'
      const allowed = JSON.parse(dz.dataset.allowed || "[]");
      // Rule check: allow only if vtype in allowed
      if(allowed.includes(vtype)){
        // Create a small copy inside lane (so original palette remains)
        const entry = document.createElement('div');
        entry.className = 'dropped';
        entry.setAttribute('data-type', vtype);
        entry.tabIndex = 0;
        entry.innerText = (vtype === 'two' ? 'üèçÔ∏è Two-wheeler' : vtype === 'emg' ? 'üöë Emergency' : 'üöó Four-wheeler');
        // add a remove button for convenience
        const rem = document.createElement('button');
        rem.style.marginLeft = '8px';
        rem.style.border = 'none';
        rem.style.background = 'transparent';
        rem.style.cursor = 'pointer';
        rem.title = 'Remove';
        rem.innerText = '‚úñ';
        rem.addEventListener('click', () => entry.remove());
        entry.appendChild(rem);
        dz.appendChild(entry);
        showMessage('Placed correctly ‚úÖ', 'ok');
      } else {
        // rejection behavior
        showMessage('Violation ‚Äî vehicle not allowed in this lane!', 'err');
        // optionally flash the lane
        dz.animate([
          { boxShadow: '0 0 0 0 rgba(239,68,68,0.0)' },
          { boxShadow: '0 0 0 10px rgba(239,68,68,0.12)' },
          { boxShadow: '0 0 0 0 rgba(239,68,68,0.0)' }
        ], { duration: 700 });
      }
    });
  });

  // Simple message toast
  let toastTimeout = null;
  function showMessage(text, kind){
    // remove existing
    const existing = document.getElementById('demo-toast');
    if(existing) existing.remove();

    const el = document.createElement('div');
    el.id = 'demo-toast';
    el.className = 'msg ' + (kind === 'ok' ? 'ok' : 'err');
    el.innerHTML = `<div style="font-weight:700">${kind === 'ok' ? 'Success' : 'Alert'}</div>
                    <div style="flex:1;color:var(--muted);font-size:0.95rem">${text}</div>`;
    document.body.appendChild(el);
    // auto remove after 3s
    if(toastTimeout) clearTimeout(toastTimeout);
    toastTimeout = setTimeout(() => { el.remove(); }, 3000);
  }

  // Accessibility: allow keyboard "drop" simulation (select palette then lane)
  // Basic approach: select one vehicle (click) then press "Enter" on lane dropzone to place
  let selectedVehicleId = null;
  document.querySelectorAll('.vehicle').forEach(v=>{
    v.addEventListener('click', ()=> {
      document.querySelectorAll('.vehicle').forEach(x=> x.style.boxShadow='');
      v.style.boxShadow = '0 0 0 3px rgba(11,116,222,0.08)';
      selectedVehicleId = v.id;
    });
    v.addEventListener('keydown', (e)=>{
      if(e.key === 'Enter' || e.key === ' '){
        v.click();
      }
    });
  });

  document.querySelectorAll('.dropzone').forEach(dz=>{
    dz.tabIndex = 0;
    dz.addEventListener('keydown', (e)=>{
      if((e.key === 'Enter' || e.key === ' ') && selectedVehicleId){
        // simulate drop
        const vehicle = document.getElementById(selectedVehicleId);
        const vtype = vehicle.dataset.type;
        const allowed = JSON.parse(dz.dataset.allowed || "[]");
        if(allowed.includes(vtype)){
          const entry = document.createElement('div');
          entry.className = 'dropped';
          entry.setAttribute('data-type', vtype);
          entry.innerText = (vtype === 'two' ? 'üèçÔ∏è Two-wheeler' : vtype === 'emg' ? 'üöë Emergency' : 'üöó Four-wheeler');
          const rem = document.createElement('button');
          rem.style.marginLeft = '8px'; rem.style.border='none'; rem.style.background='transparent'; rem.style.cursor='pointer'; rem.title='Remove'; rem.innerText='‚úñ';
          rem.addEventListener('click', ()=>entry.remove());
          entry.appendChild(rem);
          dz.appendChild(entry);
          showMessage('Placed correctly ‚úÖ', 'ok');
        } else {
          showMessage('Violation ‚Äî vehicle not allowed in this lane!', 'err');
          dz.animate([
            { transform: 'translateX(0)' },
            { transform: 'translateX(-6px)' },
            { transform: 'translateX(6px)' },
            { transform: 'translateX(0)' }
          ], { duration: 400 });
        }
      }
    });
  });

  // Optional: prefill lanes with a few items to show example usage
  (function addExamples(){
    const l1 = document.getElementById('lane-1');
    const l3 = document.getElementById('lane-3');
    const b1 = document.createElement('div'); b1.className='dropped'; b1.innerText='üèçÔ∏è Two-wheeler'; l1.appendChild(b1);
    const c1 = document.createElement('div'); c1.className='dropped'; c1.innerText='üöó Four-wheeler'; l3.appendChild(c1);
  })();

</script>
</body>
</html>
